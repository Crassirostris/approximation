\documentclass[11pt,a4paper,oneside]{article}

%\usepackage{pscyr}
\usepackage[T2A]{fontenc}
\usepackage[utf8x]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{expdlist}
\usepackage[dvips]{graphicx}
\usepackage{amsmath}
\usepackage[makeroom]{cancel}
\usepackage{svg}
\usepackage[top=1in, bottom=1in, left=1in, right=1in]{geometry}
\usepackage{indentfirst}

\begin{document}

\begin{center}
	{Вяцков Михаил, КН-401}
	
	{\huge \bf Лабораторная работа №1}
\end{center}

По условиям лабораторной

$$ k = 3 $$
$$ a = 1 + 0.1 k = 1.3 $$
$$ b = 2 - 0.1 k = 1.7 $$
$$ \sigma = 0.5 \cdot 10^{-4} $$

Рассматриваемый ряд имеет вид:

$$ \sum_{n = 1}^{\infty} \frac{1}{0.2n^2 + 1.3n + 1.7} = \xi = 1.39447 $$

Рассмотрим последовательно исходный ряд и все улучшения

\section{Предисловие}

При анализе каждого метода мы будем составлять выражение, которое содержит в себе бесконечный ряд и еще некоторое количество слагаемых, состоящих из констант и арифметических операций над ними. Так как константы нам известны с любой заданной наперед точностью, единственный вопрос, который встает перед нами --- оценка точности вычисления бесконечного рада.

В каждом случае ряд будет монотонно сходится к какому-то числу и в силу этого, взяв остаток ряда с некоторого достаточно далекого члена, мы получим, что его абсолютное значение не будет превосходить точности и его можно просто проигнорировать.

Будем считать в дальнейшем, что мы работаем в десятичной арифметике, с мантиссой длины $t$, то есть относительная погрешность числа в представлении с плавающей запятой будет $0.5 \cdot 10^{-t}$.

Напомню, что при сложении относительная прогрешность равна максимуму из относительных погрешностей, а при умножении и делении относительные погрешности складываются. При вычитании складываются абсолютные погрешности. Но так как все операци проводятся на компьютере, то при каждой операции в относительную погрешность добавляется машинная точность.

Если погрешность при вычислении одного слагаемого в ряду составила $\delta$, то итоговая \textit{относительная} погрешность вычисления $m$ слагаемых составит

$$ err_{c}'(m) = (\delta + (m - 1) \varepsilon) $$

Допустим $\delta = k \varepsilon$, абсолютное значение величины, ошибку вычисления которой мы оцениваем, будет $\zeta$ и абсолютное зрение ошибки мы полагаем $\varDelta$, тогда можно привести следующие выкладки, из которых получается необходимая точность арифметики

$$ err_{c}(m) = err_{c}'(m) \zeta = (k + m - 1) \varepsilon \zeta
	= \frac{k + m - 1}{2} \zeta 10^{-t} = \varDelta $$
$$ t = \left\lceil \lg \left( \frac{(k + m - 1) \zeta}{2 \varDelta} \right) \right\rceil $$

Для того, чтобы не брать сумму слишком большого количества слагаемых и не делать слишком большую точность вычислений, будем ограичивать себя примерно равными значениями ошибки вычислений и ошибки метода.

\section{Анализ исходного ряда}

Оценим сверху остаточную сумму ряда, начиная с $m + 1$ слагаемого:

$$ err_{m}(m) = \sum_{n = m + 1}^{\infty} \frac{1}{0.2n^2 + 1.3n + 1.7} 
	\le \sum_{n = m + 1}^{\infty} \frac{1}{0.2n^2}
	\le 5 \sum_{n = m + 1}^{\infty} \frac{1}{n^2}
	\le 5 \int_{n = m}^{\infty} \frac{dx}{x^2}
	= 5 (- \frac{1}{x})\biggr|_{m}^{\infty}
	= \frac{5}{m}$$
	
Обозначим $\varepsilon = 0.5 \cdot 10^{-t}$, относительную погрешность хранения числа. Посчитаем относительную погрешность вычисления одного слагаемого в ряду.

$$ \frac{1}{0.2n^2 + 1.3n + 1.7} $$

Заметим, что в числителе стоит число с 0 погрешностью, значит относительная точность этого выражения равна относительной точности знаменателя. При этом можно по-разному складывать и умножать, например так:

$$ \frac{1}{0.2n^2 + 1.3n + 1.7} = \frac{10}{2 \cdot n \cdot n + 13 \cdot n + 17} $$

Используя то, что небольшие целые числа хранятся в памяти с нулевой точностью

$$ \delta\left( \frac{10}{2 \cdot n \cdot n + 13 \cdot n + 17} \right) = 7 \varepsilon $$

Теперь вспомним исходную задачу, надо сравнить ошибку со значеним $\sigma$

$$ err(m) = err_{c} + err_{m} = 2 err_{m} \le \sigma $$
$$ \frac{10}{m} \le 0.5 \cdot 10^{-4} $$
$$ m \ge 2 \cdot 10^5 $$
$$ t = \left\lceil \lg(\frac{(m + 6) m \xi}{10}) \right\rceil = 10 $$

Таким образом, для достижения необходимой точности надо взять $ 2 \cdot 10^5 $ слагаемых и вычисления проводит с точностью до 10 знака после запятой.

\section{Улучшение исходного ряда}

\subsection{Улучшение рядом $ \sum_{n = 1}^{\infty} \frac{1}{n^2} $}
	
Оценим погрешность метода. Для этого заметим для начала.

$$ \sum_{n = 1}^{\infty} \frac{1}{0.2n^2 + 1.3n + 1.7} =
	\sum_{n = 1}^{\infty} \frac{5}{n^2 + 6.5n + 8.5} =
	\sum_{n = 1}^{\infty} \frac{5}{n^2 + 6.5n + 8.5} + \frac{5}{n^2} - \frac{5}{n^2} = $$
$$ 5 \sum_{n = 1}^{\infty} \frac{1}{n^2} +
	5 \sum_{n = 1}^{\infty} \frac{1}{n^2 + 6.5n + 8.5} - \frac{1}{n^2} = 
	\frac{5\pi^2}{6} +
	5 \sum_{n = 1}^{\infty} \frac{n^2 - (n^2 + 6.5n + 8.5)}{n^2 (n^2 + 6.5n + 8.5)} = $$
$$ \frac{5\pi^2}{6} -
	5 \sum_{n = 1}^{\infty} \frac{6.5n + 8.5}{n^2 (n^2 + 6.5n + 8.5)} = 
	\frac{5\pi^2}{6} -
	\frac{5 \cdot 13}{2} \sum_{n = 1}^{\infty} \frac{n + \frac{17}{13}}{n^2 (n^2 + 6.5n + 8.5)}$$
	
Оценим остаток суммы ряда, если мы взяли только $m$ слагаемых.

$$ \sum_{n = m + 1}^{\infty} \frac{n + \frac{17}{13}}{n^2 (n^2 + 6.5n + 8.5)} \le
	\sum_{n = m + 1}^{\infty} \frac{n + \frac{17}{13}}{n^4} = 
	\sum_{n = m + 1}^{\infty} \frac{1}{n^3} + \frac{17}{13 n^4} \le
	\int_{m}^{\infty} \biggr(\frac{1}{x^3} + \frac{17}{13 x^4}\biggr)dx $$
$$ \int_{m}^{\infty} \biggr(\frac{1}{x^3} + \frac{17}{13 x^4}\biggr) dx
	= \biggr( - \frac{1}{2x^2} - \frac{17}{39 x^3} \biggr) \biggr|_{m}^{\infty} =
	\frac{1}{2 m^2} + \frac{17}{39 m^3} $$
	
$$ err_{m}(m) =
	\biggr|-\frac{65}{2} \sum_{n = m + 1}^{\infty}
		\frac{n + \frac{17}{13}}{n^2 (n^2 + 6.5n + 8.5)}\biggr| \le
	\frac{65}{4m^2} + \frac{17 \cdot 65}{78m^3} $$
	
Можно организовать вычисления таким образом, чтобы позже показать, что

$$ \delta \left( \frac{n + \frac{17}{13}}{n^2 (n^2 + 6.5n + 8.5)} \right) \le 13 \varepsilon $$
	
По старой схеме вычислим

$$ 2 err_{m}(m) = \frac{130}{4m^2} + \frac{17 \cdot 130}{78m^3} \le 0.5 \cdot 10^{-4} $$

Заметив, что второе слагаемое в левой части на порядок $m$ меньше, чем первое, опустим его и посчитаем $m$ в таком случае. Для того, чтобы определить точное минимальное допустимое значение, возможно будет необходимо рассмотреть несколько чисел, больших, чем получившееся.

$$ \frac{130}{4m_1^2} \le 0.5 \cdot 10^{-4} $$
$$ m_1 \ge \sqrt{\frac{130 \cdot 10^5}{4 \cdot 5}} > 806 $$

Заметим, что значение $807$, первое допустимое для $m_1$ уже допустимо для исходного уравнения, так как

$$ \frac{130}{4 \cdot 807^2} + \frac{17 \cdot 130}{78 \cdot 807^3} \approx 4.996 \cdot 10^{-5}
	\le 5 \cdot 10^{-5} $$
$$ \implies m \ge 807 $$

Теперь абсолютное значение, к которому сходится \textit{ряд}, можно оценить как

$$ \mu = \frac{5 \pi^2}{6} - \xi \approx 6.8 \le 7 $$

$$ t = \left\lceil \lg\left(
	\frac{(m + 12) \mu}{2} \left(
		\frac{130}{4m^2} + \frac{17 \cdot 130}{78m^3} \right)^{-1} \right) \right\rceil = 8 $$
	
\subsection{Улучшение рядом $ \sum_{n = 1}^{\infty} \frac{1}{n^3} $}
	
Улучшим далее наши оценки следующим образом

$$ \frac{5}{2} \sum_{n = 1}^{\infty} \biggr[ \frac{13n + 17}{n^2 (n^2 + 6.5n + 8.5)} - 
	\frac{13}{n^3} + \frac{13}{n^3} \biggr] =$$
$$ \frac{5 \cdot 13}{2} \sum_{n = 1}^{\infty} \frac{1}{n^3} +
	\frac{5}{2} \sum_{n = 1}^{\infty}
	\frac{\cancel{13 n^4} + 17n^3 - \cancel{13 n^4} -
	13 \cdot 6.5 n^3 - 13 \cdot 8.5 n^2}{n^5 (n^2 + 6.5n + 8.5)} = $$
$$ \frac{5 \cdot 13}{2} \zeta(3) +
	\frac{5}{4} \sum_{n = 1}^{\infty}
	\frac{34 n^3 -
	13 \cdot 13 n^3 - 13 \cdot 17 n^2}{n^5 (n^2 + 6.5n + 8.5)} = $$
$$ \frac{5 \cdot 13}{2} \zeta(3) -
	\frac{5}{4} \sum_{n = 1}^{\infty}
	\frac{135 n^3 + 221 n^2}{n^5 (n^2 + 6.5n + 8.5)}$$
	
Где $\zeta(x)$ --- дзета-функция Рейманна.
	
Аналогичным образом посчитаем погрешность метода через остаток ряда

$$ \delta\left( \frac{135 n + 221}{n^3 (n^2 + 6.5n + 8.5)} \right) \le 15 \varepsilon $$
$$ err_{m}(m) = \biggr| - \frac{5}{4} \sum_{n = m + 1}^{\infty}
		\frac{135 n + 221}{n^3 (n^2 + 6.5n + 8.5)} \biggr|
	\le \frac{5 \cdot 135}{4} \sum_{n = m + 1}^{\infty}
		\frac{n + \frac{221}{135}}{n^3 (n^2 + 6.5n + 8.5)} \le $$
$$ \le \frac{675}{4} \sum_{n = m + 1}^{\infty}
		\frac{n + \frac{221}{135}}{n^5}
	\le \frac{675}{4} \left( \frac{1}{3 m^3} + \frac{221}{540 m^4} \right) \le 0.25 \cdot 10^{-4} $$
	
Опять же, одно из слагаемых получается на порядок меньше, чем второе

$$ \frac{675}{12 m_1^3} \le 0.25 \cdot 10^{-4}  $$
$$ m_1 \ge \sqrt[3]{\frac{675 \cdot 10^6}{12 \cdot 25}} \approx 131.04 > 131 $$

Подставив это значние в исходное уравнение, обнаруживаем, что 132, первое возможное значение для $m_1$ снова уже подоходит в качестве оценки $m$

$$ \frac{675}{4} \left( \frac{1}{3 \cdot 132^3} + \frac{221}{540 \cdot 132^4} \right)
	\approx 0.247 \cdot 10^{-4} \le 0.25 \cdot 10^{-4} $$
$$ \implies m \ge 132 $$

Оценим сумму ряда, чтобы сопоставить относительную погрешность с абсолютной

$$ \mu = \xi + \frac{65}{2} \zeta(3) - \frac{5 \pi^2}{6} \approx 32.2 \le 33 $$

$$ t = \left\lceil \lg\left(
	\frac{(m + 14) \mu}{2} \left(
		\frac{675}{4} \left( \frac{1}{3 m^3} + \frac{221}{540 m^4} \right)
	\right)^{-1} \right) \right\rceil = 8 $$
		
\subsection{Улучшение рядом $ \sum_{n = 1}^{\infty} \frac{1}{n^4} $}
		
Улучшим далее наши оценки следующим образом

$$ \frac{5}{4} \sum_{n = m + 1}^{\infty}
	\biggr[ \frac{135 n^3 + 221 n^2}{n^5 (n^2 + 6.5n + 8.5)} - 
	\frac{135}{n^4} + \frac{135}{n^4} \biggr] =$$
$$ \frac{5 \cdot 135}{4} \sum_{n = 1}^{\infty} \frac{1}{n^4} +
	\frac{5}{8} \sum_{n = 1}^{\infty}
	\frac{\cancel{270 n^7} + 442 n^6 - \cancel{270 n^7} -
		135 \cdot 13 n^6 - 135 \cdot 17 n^5}{n^9 (n^2 + 6.5n + 8.5)} = $$
$$ \frac{5 \cdot 135}{4} \frac{\pi^4}{90} -
	\frac{5}{8} \sum_{n = 1}^{\infty}
	\frac{1313 n^6 + 2295 n^5}{n^9 (n^2 + 6.5n + 8.5)} = $$
$$ \frac{15 \pi^4}{8} -
	\frac{5}{8} \sum_{n = 1}^{\infty}
	\frac{1313 n^6 + 2295 n^5}{n^9 (n^2 + 6.5n + 8.5)} $$

$$ \delta\left( \frac{1313 n + 2295}{n^4 (n^2 + 6.5n + 8.5)} \right) \le 17 \varepsilon $$

$$ err_{m}(m) =
	\biggr| - \frac{5}{8} \sum_{n = m + 1}^{\infty}
		\frac{1313 n + 2295}{n^4 (n^2 + 6.5n + 8.5)} \biggr|
	\le \frac{5 \cdot 1313}{8} \sum_{n = m + 1}^{\infty} \frac{n + \frac{2295}{1313}}{n^6} \le $$
$$ \le \frac{6565}{8} \left( \frac{1}{4 m^4} + \frac{2295}{6565 m^5} \right)
	\le 0.25 \cdot 10^{-4} $$
	
Применим снова стратегию, откинув сначала элемент с меньшим порядком.

$$ \frac{6565}{32 m_1^4} \le 0.25 \cdot 10^{-4} $$
$$ m_1 \ge \sqrt[4]{ \frac{6565 \cdot 10^6}{32 \cdot 25} } > 53 $$

Нам опять повезло
$$ \frac{6565}{8} \left( \frac{1}{4 54^4} + \frac{2295}{6565 54^5} \right)
	\approx 0.248 \cdot 10^{-4} \le 0.25 \cdot 10^{-4} $$
$$ \implies m \ge 54 $$

Как ранее, оценим сумму ряда

$$ \mu = \frac{5 \pi^2}{6} - \frac{65}{2} \zeta(3) + \frac{14 \pi^4}{8} - \xi = 138.2 \le 139 $$

$$ t = \left\lceil \lg\left(
	\frac{(m + 16) \mu}{2} \left(
		\frac{6565}{8} \left( \frac{1}{4 m^4} + \frac{2295}{6565 m^5} \right)
	\right)^{-1} \right) \right\rceil = 9 $$

\section{Вычислительный эксперимент}

\begin{tabular}{ | l | l | l | l | l | l | }
	\hline
	N
		& Точность
		& Исходный ряд
		& Улучшение (1)
		& Улучшение (2)
		& Улучшение (3) \\ \hline
	20
		& 15
		& 1.1837195539
		& 1.4275736686
		& \underline{1.3}889291796
		& \underline{1.39}54506421 \\ \hline
	100 
		& 15
		& \underline{1.3}462762433
		& \underline{1.39}60270766
		& \underline{1.3944}182454
		& \underline{1.39447}36572 \\ \hline
	1000
		& 15
		& \underline{1.3}894903965
		& \underline{1.3944}878974
		& \underline{1.39447}16636
		& \underline{1.39447}17198 \\ \hline
	$ 2 \cdot 10^5 $
		& 10
		& \underline{1.3944}467193
		& 
		& 
		& \\ \hline
	807
		& 8
		& 
		& \underline{1.3944}965600
		& 
		&  \\ \hline
	132
		& 8
		& 
		& 
		& \underline{1.3944}480800
		&  \\ \hline
	54
		& 9
		& 
		& 
		& 
		& \underline{1.3944}935620 \\ \hline
\end{tabular}

\section{Выводы}

Практические результаты сошлись с аналитическими расчетами, оставив немаленький зазор в значениях, возникший из-за очень слабых оценок.

Последовательное улучшение известными рядами дали экспоненциальное уменьшение количества слагаемых, требуемых для достижения необходимой точности.

\end{document}
